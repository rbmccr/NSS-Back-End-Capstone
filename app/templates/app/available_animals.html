{% extends 'app/index.html' %}

{% block style %}
  <style>

    /* align cards in grid */
    .card-container {
      display: grid;
      grid-template-columns: 27.93% 27.93% 27.93%; /* 310px card / 1110px container */
      justify-content: space-evenly;
    }

    /* control max height of card body below image */
    .card-body {
      max-height: 130px;
    }

    /* override bootstrap card-text margin */
    .card-text {
      margin-bottom: 6px;
    }

    /* establish dimension of cards outside of media queries */
    .card {
      width: 310px;
      height: 435px; /* was 450px */
      margin-bottom: 15px;
      position: relative;
    }

    /* position links to animal detail pages */
    .card > a {
      width: 33%;
      position: absolute;
      bottom: 17%; /* was 2.5% */
      right: 5%; /* was 33% */
    }

    .card > img {
      width: 310px;
      height: 310px;
    }

    /* align filters in each column in form */
    .filters {
      display: grid;
      grid-template-columns: auto auto auto;
      justify-content: space-around;
    }

    /* used to center animal cards in body if window between 1200px and 992px */
    @media only screen and (max-width: 1200px) and (min-width:992px) {
      .card-container {
        grid-template-columns: 32.25% 32.25% 32.25%; /* 300px card / 960px container */
      }

      .card {
        width: 300px;
        height: 420px;
      }
      .card > img {
        width: 300px;
        height: 300px;
      }
    }

    /* used to center animal cards in body if window between 992px and 768px */
    @media only screen and (max-width: 992px) and (min-width:768px) {
      .card-container {
        grid-template-columns: auto auto;
      }
    }

    /* used to center animal cards in body if window smaller than 768px */
    @media only screen and (max-width: 768px) {
      .card-container {
        display: grid;
        grid-template-columns: auto;
        justify-content: center;
      }
    }

    /* used to scale animal cards in body if window smaller than 360px (used for iphone5 width of 320px) */
    @media only screen and (max-width: 360px) {
      .card {
        width: 280px;
      }
      .card > img {
        width: 280px;
        height: 280px;
      }
    }

  </style>
{% endblock style %}

{% block content %}
  <div class='pb-2 mt-4 mb-4 border-bottom'>
    <h3>Available Pets</h3>
  </div>

  <div class='messages'>
    {% for message in messages %}
      <div class='{{ message.tags }} alert alert-info' role='alert'>{{ message }}</div>
    {% endfor %}
  </div>


  <div class='card mb-3' style='width: 100%; height: auto;'>
    <div class='card-header'>
      Apply a filter or search by name
    </div>

    <div class='card-body'>

        <form class=" filters ml-lg-auto my-2 my-lg-0" action="{% url 'app:search_pets' %}" method="POST">
          {% csrf_token %}
          <input type="hidden" value="{{ animal_species }}" name="animal_species">
          <input type="hidden" value="{{ animal_age }}" name="animal_age">
          <div class="">
            <div class="btn-group" role="group" aria-label="animal filters">
              {% if animal_species == 'cat' %}
                <button type="submit" class="btn btn-outline-dark active" name="cat" value="cat">&nbsp;&nbsp; Cat &nbsp;&nbsp;</button>
              {% else %}
                <button type="submit" class="btn btn-outline-dark" name="cat" value="cat">&nbsp;&nbsp; Cat &nbsp;&nbsp;</button>
              {% endif %}
              {% if animal_species == 'dog' %}
                <button type="submit" class="btn btn-outline-dark active" name="dog">&nbsp;&nbsp; Dog &nbsp;&nbsp;</button>
              {% else %}
                <button type="submit" class="btn btn-outline-dark" name="dog">&nbsp;&nbsp; Dog &nbsp;&nbsp;</button>
              {% endif %}
              {% if animal_species == 'other' %}
                <button type="submit" class="btn btn-outline-dark active" name="other">&nbsp; Other &nbsp;</button>
              {% else %}
                <button type="submit" class="btn btn-outline-dark" name="other">&nbsp; Other &nbsp;</button>
              {% endif %}
            </div>
          </div>
          <div class=''>
            <div class="btn-group" role="group" aria-label="animal filters">
              {% if animal_age == 'young' %}
                <button type="submit" class="btn btn-outline-dark active" name="young" value='young'>&nbsp; Young &nbsp;</button>
              {% else %}
                <button type="submit" class="btn btn-outline-dark" name="young" value='young'>&nbsp; Young &nbsp;</button>
              {% endif %}
              {% if animal_age == 'adult' %}
                <button type="submit" class="btn btn-outline-dark active" name="adult" value='adult'>&nbsp; Adult &nbsp;</button>
              {% else %}
                <button type="submit" class="btn btn-outline-dark" name="adult" value='adult'>&nbsp; Adult &nbsp;</button>
              {% endif %}
              {% if animal_age == 'senior' %}
                <button type="submit" class="btn btn-outline-dark active" name="senior" value='senior'>&nbsp; Senior &nbsp;</button>
              {% else %}
                <button type="submit" class="btn btn-outline-dark" name="senior" value='senior'>&nbsp; Senior &nbsp;</button>
              {% endif %}
            </div>
          </div>
          <div class=''>
            <div class="input-group">
              <input class="form-control" name="name_query" type="search" placeholder="Search by name" aria-label="Search">
              <div class="input-group-append">
                <button class="btn btn-outline-dark" type="submit"><i class="fas fa-search"></i></button>
              </div>
            </div>
          </div>
        </form>

    </div>

  </div>

  <div class='card-container'>
    {% for animal in animals %}
      <div class='card'>
        <img class='card-img-top' src='{{ animal.image.url }}' alt='{{ animal.name }}'>
        <a href="{% url 'app:animal_detail' animal.id %}" class='btn btn-outline-dark btn-sm'>View</a>
        <div class='card-body'>
          <h5 class='card-title'>{{ animal.name }}</h5>
          <p class='card-text'>{{ animal.breed }}</p>
          <p class='card-text'>Age: {{ animal.age }}</p>
        </div>
      </div>
    {% endfor %}
  </div>
{% endblock content %}